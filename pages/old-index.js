import React,{useState,useEffect,useRef}from 'react';import Head from 'next/head';import {createClient}from '@supabase/supabase-js';export default function Shamana(){const[currentSlide,setCurrentSlide]=useState(0);const[isPlaying,setIsPlaying]=useState(false);const[isLiked,setIsLiked]=useState(false);const[showDropdown,setShowDropdown]=useState(false);const[showPlaylist,setShowPlaylist]=useState(false);const[currentSong,setCurrentSong]=useState(null);const[songs,setSongs]=useState([]);const[currentTime,setCurrentTime]=useState(0);const[duration,setDuration]=useState(0);const[volume,setVolume]=useState(1);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[shuffle,setShuffle]=useState(false);const[repeat,setRepeat]=useState(false);const[playedIndices,setPlayedIndices]=useState(new Set());const audioRef=useRef(null);const autoPlayRef=useRef(null);const supabaseUrl=process.env.NEXT_PUBLIC_SUPABASE_URL;const supabaseKey=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;const supabase=createClient(supabaseUrl,supabaseKey);const slides=[{id:1,title:"Discover Your Sound",description:"Create, share, and explore music with a global community of artists and listeners.",buttonText:"Create Playlist",buttonStyle:{},background:"carousel-slide-1"},{id:2,title:"Collaborate & Create",description:"Join forces with other music lovers to create extraordinary playlists that transport listeners to different timelines. Get rewarded with exclusive NFTs for creating content that resonates with people who love it just as much.",buttonText:"Start Collaborating",buttonStyle:{background:"#000",color:"#fff"},background:"carousel-slide-2"},{id:3,title:"Find Your Trybe",description:"Join Trybes that match your unique vibe and connect with music lovers who share your taste. Discover new music, share your creations, and build lasting connections with people who get your sound.",buttonText:"Explore Trybes",buttonStyle:{},background:"carousel-slide-3"}];const activities=[{id:1,creator:"Alex Turner",time:"2 hours ago",playlist:"Indie Rock Essentials",gradient:"linear-gradient(135deg,#6a11cb,#2575fc)",songs:["Do I Wanna Know? - Arctic Monkeys","Time to Pretend - MGMT","Last Nite - The Strokes"],comment:{user:"Sarah Chen",text:"This playlist is amazing! Added to my library.",time:"30 minutes ago"}},{id:2,creator:"Maya Rodriguez",time:"1 day ago",playlist:"Chill Vibes Only",gradient:"linear-gradient(135deg, #ff9a9e, #fad0c4)",songs:["Breathe Deeper - Tame Impala","Apocalypse - Cigarettes After Sex","The Night We Met - Lord Huron"],comment:{user:"Jamal Williams",text:"Perfect for my study sessions, thanks!",time:"12 hours ago"}},{id:3,creator:"DJ Nova",time:"3 days ago",playlist:"Electronic Sunrise",gradient:"linear-gradient(135deg, #0cebeb, #20e3b2, #29ffc6)",songs:["Strobe - Deadmau5","Language - Porter Robinson","Innerbloom - RÃœFÃœS DU SOL"],comment:{user:"Liam Thompson",text:"This mix got me through my morning run! ðŸ”¥",time:"2 days ago"}},{id:4,creator:"Sophia Williams",time:"5 days ago",playlist:"90s Throwback",gradient:"linear-gradient(135deg, #8360c3, #2ebf91)",songs:["Wonderwall - Oasis","Zombie - The Cranberries","Smells Like Teen Spirit - Nirvana"],comment:{user:"Marcus Brown",text:"Nostalgia hitting hard with this one! Great selection.",time:"4 days ago"}},{id:5,creator:"Carlos Mendez",time:"1 week ago",playlist:"Latin Heat",gradient:"linear-gradient(135deg, #ff5e62, #ff9966)",songs:["Despacito - Luis Fonsi","Mi Gente - J Balvin","Taki Taki - DJ Snake"],comment:{user:"Elena Rodriguez",text:"Â¡Esto es fuego! Perfect for summer parties.",time:"6 days ago"}}];const trybes=["Indie Rock Collective","Electronic Dance","Hip-Hop Heads","Jazz Enthusiasts","R&B Soul","90s Nostalgia","Latin Beats"];const events=[{day:"15",month:"Sep",title:"Indie Rock Jam Session",details:"8:00 PM â€¢ Virtual"},{day:"18",month:"Sep",title:"Electronic Music Workshop",details:"7:30 PM â€¢ Studio A"},{day:"22",month:"Sep",title:"Hip-Hop Beat Making",details:"6:00 PM â€¢ The Loft"},{day:"25",month:"Sep",title:"R&B Vocal Session",details:"5:00 PM â€¢ Vocal Booth"}];useEffect(()=>{fetchSongs();},[]);const fetchSongs=async()=>{try{setError(null);const{data,error}=await supabase.from('songs').select('*').order('created_at',{ascending:true});if(error){console.error('Error fetching songs:',error);setError('Failed to load songs');return;}if(data&&data.length>0){setSongs(data);setCurrentSong(data[0]);}else{setError('No songs available');}}catch(error){console.error('Error fetching songs:',error);setError('Failed to load songs');}};useEffect(()=>{startAutoPlay();return()=>{if(autoPlayRef.current){clearInterval(autoPlayRef.current);}}},[]);const startAutoPlay=()=>{if(autoPlayRef.current){clearInterval(autoPlayRef.current);}autoPlayRef.current=setInterval(()=>{setCurrentSlide((prev)=>(prev+1)%slides.length);},5000);};const showSlide=(index)=>{setCurrentSlide(index);startAutoPlay();};const nextSlide=()=>{setCurrentSlide((prev)=>(prev+1)%slides.length);startAutoPlay();};const prevSlide=()=>{setCurrentSlide((prev)=>(prev-1+slides.length)%slides.length);startAutoPlay();};const getPublicUrl=(path,bucket='pli5t-songs')=>{if(!path){console.error('No path provided');return null;}try{const{data,error}=supabase.storage.from(bucket).getPublicUrl(path);if(error){console.error('Error getting public URL:',error);return null;}return data.publicUrl;}catch(error){console.error('Error in getPublicUrl:',error);return null;}};const handlePlayPause=async()=>{if(!currentSong){setError('No song selected');return;}if(audioRef.current){if(isPlaying){audioRef.current.pause();setIsPlaying(false);}else{setIsLoading(true);setError(null);try{const audioUrl=getPublicUrl(currentSong.song_path);if(!audioUrl){throw new Error('Could not get audio URL');}if(audioRef.current.src!==audioUrl){audioRef.current.src=audioUrl;await new Promise((resolve,reject)=>{audioRef.current.onloadedmetadata=resolve;audioRef.current.onerror=reject;});}await audioRef.current.play();setIsPlaying(true);}catch(error){console.error('Error playing audio:',error);setError('Failed to play audio');setIsPlaying(false);}finally{setIsLoading(false);}}}};const handleLike=()=>{setIsLiked(!isLiked);};const toggleDropdown=()=>{setShowDropdown(!showDropdown);};const togglePlaylist=()=>{setShowPlaylist(!showPlaylist);};const playSong=async(song)=>{setCurrentSong(song);setIsLoading(true);setError(null);setCurrentTime(0);setDuration(0);if(audioRef.current){try{const audioUrl=getPublicUrl(song.song_path);if(!audioUrl){throw new Error('Could not get audio URL');}audioRef.current.src=audioUrl;audioRef.current.currentTime=0;await audioRef.current.play();setIsPlaying(true);}catch(error){console.error('Error playing song:',error);setError('Failed to play song');setIsPlaying(false);}finally{setIsLoading(false);}}};const handleTimeUpdate=()=>{if(audioRef.current){setCurrentTime(audioRef.current.currentTime);if(audioRef.current.duration&&audioRef.current.duration!==duration){setDuration(audioRef.current.duration);}}};const handleProgressClick=(e)=>{if(audioRef.current&&duration){const progressBar=e.currentTarget;const rect=progressBar.getBoundingClientRect();const clickPosition=e.clientX-rect.left;const progressWidth=rect.width;const newTime=(clickPosition/progressWidth)*duration;audioRef.current.currentTime=newTime;setCurrentTime(newTime);}};const handleVolumeChange=(e)=>{const newVolume=parseFloat(e.target.value);setVolume(newVolume);if(audioRef.current){audioRef.current.volume=newVolume;}};const formatTime=(seconds)=>{if(isNaN(seconds)||!isFinite(seconds))return'0:00';const mins=Math.floor(seconds/60);const secs=Math.floor(seconds%60);return`${mins}:${secs.toString().padStart(2,'0')}`;};const getRandomSongIndex=()=>{if(songs.length===0)return 0;if(playedIndices.size>=songs.length){setPlayedIndices(new Set());}let randomIndex;do{randomIndex=Math.floor(Math.random()*songs.length);}while(playedIndices.has(randomIndex));setPlayedIndices(prev=>new Set([...prev,randomIndex]));return randomIndex;};const nextSong=()=>{if(songs.length>0&&currentSong){let nextIndex;if(shuffle){nextIndex=getRandomSongIndex();}else{const currentIndex=songs.findIndex(song=>song.id===currentSong.id);nextIndex=(currentIndex+1)%songs.length;}playSong(songs[nextIndex]);}};const prevSong=()=>{if(songs.length>0&&currentSong){const currentIndex=songs.findIndex(song=>song.id===currentSong.id);const prevIndex=(currentIndex-1+songs.length)%songs.length;playSong(songs[prevIndex]);}};const handleShuffle=()=>{setShuffle(!shuffle);setPlayedIndices(new Set());};const handleRepeat=()=>{setRepeat(!repeat);};const handleEnded=()=>{if(repeat){audioRef.current.currentTime=0;audioRef.current.play();}else{nextSong();}};useEffect(()=>{if(currentSong){setCurrentTime(0);setDuration(0);}},[currentSong]);return(<><Head><title>Shamana</title><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossOrigin="true"/><link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/></Head><style jsx global>{`*{margin:0;padding:0;box-sizing:border-box;}body{font-family:'Work Sans',sans-serif;background-color:#000;color:#fff;letter-spacing:-0.5px;max-width:1600px;margin:0 auto;padding-bottom:100px;}a{text-decoration:none;color:inherit;}.container{max-width:1200px;margin:0 auto;padding:0 15px;}.header{display:flex;align-items:center;justify-content:space-between;padding:20px;position:relative;max-width:1600px;margin:0 auto;}.logo img{height:100%;max-width:180px;}.nav{display:flex;gap:30px;}.nav a{font-weight:500;position:relative;}.nav a.active:after{content:'';position:absolute;bottom:-5px;left:0;width:100%;height:2px;background-color:#fff;}.search-bar{flex:1;max-width:400px;margin:0 20px;position:relative;}.search-bar input{width:100%;padding:8px 15px;border-radius:20px;border:none;background:#222;color:#fff;}.search-bar i{position:absolute;right:15px;top:50%;transform:translateY(-50%);color:#999;}.actions{display:flex;align-items:center;gap:15px;position:relative;}.upload-btn{display:flex;align-items:center;gap:5px;font-weight:500;cursor:pointer;}.user-account{display:flex;align-items:center;gap:8px;cursor:pointer;position:relative;}.user-account i:first-child{font-size:24px;color:#fff;}.user-account i:last-child{font-size:14px;color:#ccc;}.dropdown-content{display:${showDropdown?'block':'none'};position:absolute;top:100%;right:0;background-color:#1a1a1a;min-width:160px;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);z-index:1000;border-radius:8px;overflow:hidden;margin-top:10px;}.dropdown-item{display:flex;align-items:center;gap:10px;padding:12px 16px;color:#fff;font-size:14px;transition:background-color 0.2s;}.dropdown-item:hover{background-color:#6a11cb;}.dropdown-item i{font-size:14px;width:20px;}.hero-carousel{position:relative;margin:40px 0;border-radius:12px;overflow:hidden;height:400px;}.carousel-inner{position:relative;width:100%;height:100%;}.carousel-slide{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;transition:opacity 0.8s ease;display:flex;align-items:center;padding:0 60px;}.carousel-slide.active{opacity:1;z-index:1;}.carousel-slide-1{background:linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(106, 17, 203, 0.8) 70%),url('https://res.cloudinary.com/dqhawdcol/image/upload/v1758378695/gof3qpnmxlx9sa529c0v.jpg') center/cover;}.carousel-slide-2{background:linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(0, 180, 180, 0.8) 70%),url('https://res.cloudinary.com/dqhawdcol/image/upload/v1758378696/oiftniuktkros8hsnrpi.jpg') center/cover;}.carousel-slide-3{background:linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, rgba(25, 130, 230, 0.8) 70%),url('https://res.cloudinary.com/dqhawdcol/image/upload/v1758597436/jww80vnkttzr1ne6pl74.jpg') center/cover;}.carousel-content{max-width:600px;margin:0 auto;text-align:center;}.carousel-content h1{font-size:2.5rem;margin-bottom:15px;}.carousel-content p{font-size:1.1rem;margin-bottom:25px;opacity:0.9;}.cta-button{background:#fff;color:#6a11cb;border:none;padding:12px 30px;border-radius:30px;font-size:1rem;font-weight:600;cursor:pointer;transition:transform 0.2s;}.cta-button:hover{transform:scale(1.05);}.carousel-controls{position:absolute;bottom:20px;left:0;width:100%;display:flex;justify-content:center;z-index:10;}.carousel-dot{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.5);margin:0 5px;cursor:pointer;transition:background 0.3s ease;}.carousel-dot.active{background:rgba(255,255,255,1);}.carousel-nav{position:absolute;top:50%;transform:translateY(-50%);width:100%;display:flex;justify-content:space-between;padding:0 20px;z-index:10;}.carousel-nav button{background:rgba(0,0,0,0.5);border:none;width:40px;height:40px;border-radius:50%;color:#fff;font-size:20px;cursor:pointer;transition:background 0.3s ease;}.carousel-nav button:hover{background:rgba(0,0,0,0.8);}.content-section{display:flex;gap:30px;margin-bottom:60px;}.feed-container{flex:3;background:#111;border-radius:12px;padding:20px;}.trybe-events-container{flex:1;display:flex;flex-direction:column;gap:30px;}.trybe-container{background:#111;border-radius:12px;padding:20px;}.events-container{background:#111;border-radius:12px;padding:20px;}.section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}.section-header h2{font-size:1.5rem;font-weight:600;text-transform:none;}.view-all{color:#6a11cb;font-weight:500;}.activity-item{background:#1a1a1a;border-radius:12px;padding:20px;margin-bottom:20px;}.activity-header{display:flex;align-items:center;gap:10px;margin-bottom:15px;}.creator-avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;}.activity-info{flex:1;}.creator-name{font-weight:600;}.activity-time{font-size:0.85rem;color:#999;margin-top:3px;}.playlist-thumbnail{position:relative;height:180px;border-radius:8px;margin-bottom:15px;overflow:hidden;}.play-button{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.9);width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;}.play-button:hover{background:rgba(255,255,255,1);transform:translate(-50%,-50%) scale(1.1);}.play-button i{color:#000;font-size:20px;}.playlist-info{margin-bottom:15px;}.playlist-name{font-size:1.2rem;font-weight:600;margin-bottom:5px;}.song-list{display:flex;flex-direction:column;gap:5px;margin-bottom:15px;}.song-item{display:flex;align-items:center;gap:10px;font-size:0.9rem;color:#ccc;}.song-number{color:#6a11cb;font-weight:500;width:20px;}.comment-section{display:flex;gap:10px;align-items:flex-start;}.commenter-avatar{width:30px;height:30px;border-radius:50%;object-fit:cover;}.comment-content{flex:1;background:#222;padding:10px 15px;border-radius:18px;}.commenter-name{font-weight:500;margin-bottom:3px;}.comment-text{font-size:0.9rem;color:#ccc;}.trybe-list{display:flex;flex-direction:column;gap:15px;}.trybe-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #222;}.trybe-item:last-child{border-bottom:none;}.trybe-name{font-weight:500;}.follow-btn{background:transparent;border:1px solid #6a11cb;color:#6a11cb;padding:5px 12px;border-radius:15px;font-size:0.8rem;font-weight:500;cursor:pointer;transition:all 0.2s;}.follow-btn:hover{background:#6a11cb;color:#fff;}.events-list{display:flex;flex-direction:column;gap:15px;}.event-item{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid #222;}.event-item:last-child{border-bottom:none;}.event-date{display:flex;flex-direction:column;align-items:center;justify-content:center;background:#6a11cb;border-radius:8px;min-width:50px;height:50px;padding:5px;}.event-day{font-size:1.2rem;font-weight:600;line-height:1;}.event-month{font-size:0.7rem;text-transform:uppercase;}.event-info{flex:1;}.event-title{font-weight:500;margin-bottom:3px;}.event-details{font-size:0.8rem;color:#ccc;}.join-btn{background:transparent;border:1px solid #6a11cb;color:#6a11cb;padding:5px 12px;border-radius:15px;font-size:0.8rem;font-weight:500;cursor:pointer;transition:all 0.2s;align-self:center;}.join-btn:hover{background:#6a11cb;color:#fff;}.player-bar{position:fixed;bottom:0;left:0;width:100%;background:linear-gradient(90deg, rgba(30,30,30,0.95), rgba(50,50,50,0.95));backdrop-filter:blur(10px);padding:20px;z-index:900;display:flex;align-items:center;justify-content:space-between;}.player-info{flex:1;max-width:30%;display:flex;align-items:center;gap:12px;}.player-image{width:48px;height:48px;border-radius:6px;object-fit:cover;background:#333;display:flex;align-items:center;justify-content:center;}.player-image i{color:#666;font-size:20px;}.player-details{flex:1;min-width:0;}.song-name{font-weight:600;font-size:0.95rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.artist-name{font-size:0.8rem;color:#ccc;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.player-controls{display:flex;align-items:center;gap:15px;}.player-controls button{background:none;border:none;color:#fff;font-size:16px;cursor:pointer;opacity:0.8;transition:opacity 0.2s;}.player-controls button:hover{opacity:1;}.player-controls button.active{color:#6a11cb;}.player-controls .play-pause{font-size:28px;position:relative;}.loading-spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:20px;height:20px;border:2px solid transparent;border-top:2px solid #6a11cb;border-radius:50%;animation:spin 1s linear infinite;}@keyframes spin{0%{transform:translate(-50%,-50%) rotate(0deg);}100%{transform:translate(-50%,-50%) rotate(360deg);}}.player-progress{flex:2;max-width:40%;display:flex;align-items:center;gap:10px;}.progress-bar{flex:1;height:4px;background:rgba(255,255,255,0.3);border-radius:2px;cursor:pointer;position:relative;overflow:hidden;}.progress{position:absolute;height:100%;background:#fff;border-radius:2px;width:${duration?(currentTime/duration)*100:0}%;transition:width 0.1s ease;}.time{font-size:0.7rem;color:#ccc;min-width:35px;}.time:first-child{text-align:right;}.volume-control{display:flex;align-items:center;gap:8px;margin-left:15px;}.volume-control i{font-size:16px;color:#ccc;}.volume-slider{width:80px;height:4px;background:rgba(255,255,255,0.3);border-radius:2px;outline:none;-webkit-appearance:none;}.volume-slider::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:50%;background:#fff;cursor:pointer;}.volume-slider::-moz-range-thumb{width:12px;height:12px;border-radius:50%;background:#fff;cursor:pointer;border:none;}.player-actions{flex:1;max-width:30%;display:flex;justify-content:flex-end;gap:15px;position:relative;}.player-actions button{background:none;border:none;color:#fff;font-size:16px;cursor:pointer;opacity:0.8;transition:opacity 0.2s;}.player-actions button:hover{opacity:1;}.player-actions button.active{color:#6a11cb;}.playlist-popup{position:absolute;bottom:100%;right:0;background:#1a1a1a;border-radius:12px;padding:15px;min-width:300px;max-height:400px;overflow-y:auto;box-shadow:0 -4px 20px rgba(0,0,0,0.5);border:1px solid #333;margin-bottom:10px;}.playlist-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #333;}.playlist-header h3{font-size:1.1rem;font-weight:600;}.close-playlist{background:none;border:none;color:#ccc;font-size:18px;cursor:pointer;}.playlist-song-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;cursor:pointer;transition:background 0.2s;}.playlist-song-item:hover{background:#2a2a2a;}.playlist-song-item.active{background:#6a11cb;}.song-thumbnail{width:40px;height:40px;border-radius:4px;object-fit:cover;background:#333;display:flex;align-items:center;justify-content:center;}.song-thumbnail i{color:#666;font-size:16px;}.song-info{flex:1;min-width:0;}.song-info .song-title{font-weight:500;font-size:0.9rem;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.song-info .song-artist{font-size:0.8rem;color:#ccc;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.mobile-nav{display:none;position:fixed;bottom:0;left:0;width:100%;background-color:#111;z-index:1000;padding:10px 0;}.mobile-nav-items{display:flex;justify-content:space-around;}.mobile-nav-item{display:flex;flex-direction:column;align-items:center;gap:3px;font-size:12px;}.mobile-nav-item i{font-size:18px;}@media (max-width:1024px){.logo img{max-width:150px;}.carousel-slide{padding:0 40px;}.carousel-content h1{font-size:2rem;}}@media (max-width:768px){.nav,.search-bar{display:none;}.logo img{max-width:120px;}.mobile-nav{display:block;}.player-bar{bottom:60px;background:linear-gradient(90deg, rgba(30,30,30,0.95), rgba(50,50,50,0.95));backdrop-filter:blur(15px);margin:10px;border-radius:30px;width:calc(100% - 20px);left:10px;padding:15px;flex-direction:row;align-items:center;gap:10px;}.player-info{max-width:none;flex:1;text-align:left;order:2;}.player-controls{order:1;gap:0;flex:0 0 auto;}.player-controls .shuffle,.player-controls .repeat,.player-controls .step-backward,.player-controls .step-forward{display:none;}.player-controls .play-pause{font-size:24px;margin-right:10px;}.player-progress{display:none;}.volume-control{display:none;}.player-actions{max-width:none;order:3;justify-content:flex-end;gap:15px;position:static;flex:0 0 auto;}.hero-carousel{height:350px;margin:20px 0;}.carousel-slide{padding:0 20px;flex-direction:column;text-align:center;justify-content:center;}.carousel-content h1{font-size:1.8rem;}.carousel-content p{font-size:1rem;}.carousel-nav{display:none;}.upload-btn{background-color:#555;padding:8px;border-radius:50%;}.upload-btn span{display:none;}.user-account i:last-child{display:none;}.content-section{flex-direction:column;}.feed-container,.trybe-events-container{width:100%;}.playlist-thumbnail{height:150px;}.dropdown-content{right:-20px;}.playlist-popup{right:-50px;min-width:250px;}}`}</style><audio ref={audioRef} onTimeUpdate={handleTimeUpdate} onEnded={handleEnded} onLoadedMetadata={()=>{if(audioRef.current){setDuration(audioRef.current.duration);}}} onError={(e)=>{console.error('Audio error:',e);setError('Audio playback error');}}/><header><div className="header"><a href="#" className="logo"><img src="https://res.cloudinary.com/dqhawdcol/image/upload/v1758379129/hkyfzlvauys6paoqo6on.png" alt="Shamana"/></a><nav className="nav"><a href="#" className="active">Home</a><a href="#">Trybe</a><a href="#">Playlists</a></nav><div className="search-bar"><input type="text" placeholder="Search..."/><i className="fas fa-search"></i></div><div className="actions"><div className="upload-btn"><i className="fas fa-cloud-upload-alt"></i><span>Upload</span></div><div className="user-account" onClick={toggleDropdown}><i className="fas fa-user-circle"></i><i className="fas fa-chevron-down"></i><div className="dropdown-content"><a href="#" className="dropdown-item"><i className="fas fa-user"></i><span>Profile</span></a><a href="#" className="dropdown-item"><i className="fas fa-award"></i><span>Rewards</span></a><a href="#" className="dropdown-item"><i className="fas fa-sign-out-alt"></i><span>Logout</span></a></div></div></div></div></header><main><div className="container"><section className="hero-carousel"><div className="carousel-inner">{slides.map((slide,index)=>(<div key={slide.id} className={`carousel-slide ${slide.background} ${index===currentSlide?'active':''}`}><div className="carousel-content"><h1>{slide.title}</h1><p>{slide.description}</p><button className="cta-button" style={slide.buttonStyle}>{slide.buttonText}</button></div></div>))}</div><div className="carousel-nav"><button className="carousel-prev" onClick={prevSlide}><i className="fas fa-chevron-left"></i></button><button className="carousel-next" onClick={nextSlide}><i className="fas fa-chevron-right"></i></button></div><div className="carousel-controls">{slides.map((_,index)=>(<div key={index} className={`carousel-dot ${index===currentSlide?'active':''}`} onClick={()=>showSlide(index)}></div>))}</div></section><section className="content-section"><div className="feed-container">{error&&<div className="error-message" style={{color:'red',padding:'10px',marginBottom:'20px'}}>{error}</div>}{activities.map((activity)=>(<div key={activity.id} className="activity-item"><div className="activity-header"><img src="https://res.cloudinary.com/dqhawdcol/image/upload/v1758202400/e9ifs1tewfgemgxfc5kc.jpg" alt="Creator" className="creator-avatar"/><div className="activity-info"><div className="creator-name">{activity.creator}</div><div className="activity-time">{activity.time}</div></div></div><div className="playlist-thumbnail" style={{background:activity.gradient}}><div className="play-button"><i className="fas fa-play"></i></div></div><div className="playlist-info"><div className="playlist-name">{activity.playlist}</div></div><div className="song-list">{activity.songs.map((song,index)=>(<div key={index} className="song-item"><span className="song-number">{index+1}</span><span className="song-title">{song}</span></div>))}</div><div className="comment-section"><img src="https://res.cloudinary.com/dqhawdcol/image/upload/v1758202400/e9ifs1tewfgemgxfc5kc.jpg" alt="Commenter" className="commenter-avatar"/><div className="comment-content"><div className="commenter-name">{activity.comment.user}</div><div className="comment-text">{activity.comment.text}</div><div className="activity-time">{activity.comment.time}</div></div></div></div>))}</div><div className="trybe-events-container"><div className="trybe-container"><div className="section-header"><h2>Trybes for you</h2><a href="#" className="view-all">View all</a></div><div className="trybe-list">{trybes.map((trybe,index)=>(<div key={index} className="trybe-item"><div className="trybe-name">{trybe}</div><button className="follow-btn">Follow</button></div>))}</div></div><div className="events-container"><div className="section-header"><h2>Upcoming Jam Sessions</h2><a href="#" className="view-all">View all</a></div><div className="events-list">{events.map((event,index)=>(<div key={index} className="event-item"><div className="event-date"><div className="event-day">{event.day}</div><div className="event-month">{event.month}</div></div><div className="event-info"><div className="event-title">{event.title}</div><div className="event-details">{event.details}</div></div><button className="join-btn">Join</button></div>))}</div></div></div></section></div></main><div className="player-bar"><div className="player-info">{currentSong?.image_path?(<img src={getPublicUrl(currentSong.image_path,'pli5t-images')} alt={currentSong.title} className="player-image"/>):(<div className="player-image"><i className="fas fa-music"></i></div>)}<div className="player-details"><div className="song-name">{currentSong?.title||'No song selected'}</div><div className="artist-name">{currentSong?.author||'Select a song to play'}</div></div></div><div className="player-controls"><button className={`shuffle ${shuffle?'active':''}`} onClick={handleShuffle}><i className="fas fa-random"></i></button><button className="step-backward" onClick={prevSong}><i className="fas fa-step-backward"></i></button><button className="play-pause" onClick={handlePlayPause} disabled={isLoading}>{isLoading?(<div className="loading-spinner"></div>):(<i className={isPlaying?"fas fa-pause-circle":"fas fa-play-circle"}></i>)}</button><button className="step-forward" onClick={nextSong}><i className="fas fa-step-forward"></i></button><button className={`repeat ${repeat?'active':''}`} onClick={handleRepeat}><i className="fas fa-redo"></i></button></div><div className="player-progress"><div className="time">{formatTime(currentTime)}</div><div className="progress-bar" onClick={handleProgressClick}><div className="progress"></div></div><div className="time">{formatTime(duration)}</div></div><div className="volume-control"><i className={`fas ${volume===0?'fa-volume-mute':volume>0.5?'fa-volume-up':'fa-volume-down'}`}></i><input type="range" className="volume-slider" min="0" max="1" step="0.01" value={volume} onChange={handleVolumeChange}/></div><div className="player-actions"><button className={`like ${isLiked?'active':''}`} onClick={handleLike}><i className={isLiked?"fas fa-heart":"far fa-heart"}></i></button><button className="playlist" onClick={togglePlaylist}><i className="fas fa-list"></i></button>{showPlaylist&&(<div className="playlist-popup"><div className="playlist-header"><h3>Playlist</h3><button className="close-playlist" onClick={togglePlaylist}><i className="fas fa-times"></i></button></div>{songs.map((song)=>(<div key={song.id} className={`playlist-song-item ${currentSong?.id===song.id?'active':''}`} onClick={()=>playSong(song)}>{song.image_path?(<img src={getPublicUrl(song.image_path,'pli5t-images')} alt={song.title} className="song-thumbnail"/>):(<div className="song-thumbnail"><i className="fas fa-music"></i></div>)}<div className="song-info"><div className="song-title">{song.title}</div><div className="song-artist">{song.author}</div></div></div>))}</div>)}</div></div><nav className="mobile-nav"><div className="mobile-nav-items"><a href="#" className="mobile-nav-item"><i className="fas fa-home"></i><span>Home</span></a><a href="#" className="mobile-nav-item"><i className="fas fa-users"></i><span>Trybe</span></a><a href="#" className="mobile-nav-item"><i className="fas fa-book"></i><span>Playlist</span></a><a href="#" className="mobile-nav-item"><i className="fas fa-search"></i><span>Search</span></a></div></nav></>);}
